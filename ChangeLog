2013-06-26  Gary V. Vaughan  <gary@gnu.org>

	Release version 8
	* NEWS: Record release date.

	specs: correct output from instantiate_a matcher.
	Without this changeset, output from failed instantiate_a matches
	aresmooshedtogetherlikethis.
	* specs/spec_helper.lua (matchers.instantiate_a::format_actual):
	Add missing leading space.
	(matchers.instantiate_a::format_expect): Add missing leading space,
	and trailing comma.

	stdlib: sync with upstream.
	* lib/specl/std.lua: Improved Object implementation.
	Adjust all clients.
	* lib/specl/matchers.lua (Matcher::_type): Capitalize typename to
	match stdlib pattern.
	Adjust all clients.
	* lib/specl/shell.lua (Command::_type): Likewise.
	(Process::_type): Likewise.
	* lib/specl/util.lua (type_check): Detect an Object based type
	with `type (x) == "table" and Object.type (x) ~= "table"` rather
	than encoding knowledge about the object layout (which just
	changed with this update, and broke here in a hard to find way!).
	* specs/shell_spec.yaml: Adjust for capitalized type names.

2013-06-01  Gary V. Vaughan  <gary@gnu.org>

	formatters: no need to hardcode 'not yet implemented' in progress.
	* lib/specl/formatter/progress.lua (expectations): Like the report
	formatter, we can rely on status.ispending or expectation.pending
	to hold a suitable string, without hardcoding 'not yet implemented'
	as a fallback.

2013-05-31  Gary V. Vaughan  <gary@gnu.org>

	formatters: insert missing space in unexpected pass message for report.
	* lib/specl/formatter/report.lua: Insert a missing space in the
	unexpected pass message.

2013-05-25  Gary V. Vaughan  <gary@gnu.org>

	formatters: report pending argument strings consistently.
	* specs/formatter/spec_helper.lua (run_spec): Accept additional
	arguments to SPECL call.
	* specs/formatter/report_spec.yaml: Specify output for various
	combinations of pending calls in example specs.
	* specs/specl_spec.yaml: Loosen specification to allow additional
	pending argument display.
	* lib/specl/matchers.lua (pending): Always save the argument
	as a string, defaulting to "not yet implemented".
	* lib/specl/formatter/report_spec.yaml: Display pending argument
	strings consistently.
	* NEWS: Update.

	formatters: report 'No expectations' instead of 'nan% of expectations'
	* specs/formatters_spec.yaml: Move from here...
	* specs/custom_formatters_spec.yaml: ...to here.
	* specs/formatter/spec_helper.lua: New file. Implement spec
	runner helper.
	* specs/formatter/report_spec.yaml: Specify correct output from
	report formatter.
	* specs/specs.mk (specl_SPECS): Add
	specs/formatter/report_spec.yaml.
	(EXTRA_DIST): Add specs/formatter/spec_helper.lua.
	* lib/specl/formatter/report.lua (footer): When there are zero
	passing expectations, don't trigger a DIVBYZERO, just report "No
	expectations met".
	* NEWS: Update.

	docs: clarify YAML string quotation rules.
	* docs/specl.md (YAML): Not all punctuation forces description
	strings to require quotes, only punctuation that is ambiguous to
	the YAML parser.
	* specs/matchers_spec.yaml, specs/specl_spec.yaml: Remove
	unnecessary description quoting.

2013-05-24  Gary V. Vaughan  <gary@gnu.org>

	slingshot: sync with upstream.
	* slingshot: Sync with upstream for scm_rockspec distribution.

2013-05-22  Gary V. Vaughan  <gary@gnu.org>

	stdlib: sync with upstream.
	* lib/specl/std.lua (M.type): Use rawget to avoid triggering
	__index metamethod when _type is not present.

2013-05-21  Gary V. Vaughan  <gary@gnu.org>

	matchers: equal matcher now understands std.objects.
	* specs/matchers_spec.yaml: Specify desired behaviour when
	comparing objects with the equal matcher.
	* lib/specl/matchers.lua (objcmp): Compare the contents of
	std.object derived types.
	* docs/specl.md (equal): Update.
	* NEWS: Update.

2013-05-20  Gary V. Vaughan  <gary@gnu.org>

	matchers: contain matcher now accepts std.objects.
	Now that stdlib objects convert to tables by default (which in
	turn prettyprint with ordered keys suitable for expectations to
	compare against), should_contain can coerce an unknown object to
	a table and search within that.
	* specs/matchers_spec.yaml: Specify desired behaviour when passing
	an object to the contain matcher.
	* lib/specl/util.lua (type_check): Support "object" in the type
	list, to denote a table that object.type recognises.
	(M.totable): Re-export this from specl.std.
	* lib/specl/matchers.lua (matchers.contain): Accept an object, and
	coerce it to a table with std.table for comparison purposes.
	* docs/specl.md (contain): Update.
	* NEWS: Update.

	stdlib: import prettyprint improvements from upstream.
	* lib/specl/std.lua (render): Output table keys in order.
	(prettytostring): Omit quoting for table keys that are already
	valid symbol names.

	stdlib: resync from upstream and reorganise hierarchically.
	* lib/specl/std.lua (std): Return this new top-level namespace.
	(std.func): New namespace for std.functional apis.
	(std.string, std.io): Likewise.
	(std.table): Likewise, adding totable api from upstream.
	(std.object): Likewise, with a callable metatable like upstream.
	(std.strbuf): Likewise, sync with Object based upstream
	implementation.
	* lib/specl/util.lua: Adjust.

	stdlib: update object implementation from upstream.
	* lib/specl/std.lua (Object, new, object): Update to typed object
	from upstream.
	* lib/specl/util.lua (Object, typeof): Remove custom type layer.
	(object, object.type): Re-export apis from "specl.std".
	Adjust all callers.

	travis: regenerate .travis.yml.
	* .travis.yml: Regenerate from Slingshot.

2013-05-19  Gary V. Vaughan  <gary@gnu.org>

	slingshot: let slingshot manage its own files.
	* GNUmakefile, Makefile.am, build-aux/do-release-commit-and-tag,
	build-aux/gitlog-to-changelog, build-aux/mail, build-aux/mkrockspecs,
	build-aux/release.mk, build-aux/rockspecs.mk, build-aux/sanity.mk,
	build-aux/specl.mk, m4/ax_compare_version.m4, m4/ax_lua.m4,
	travis.yml.in: Remove.  Slingshot will pull back the right versions
	during bootstrap.
	* slingshot: New git submodule.
	* bootstrap, bootstrap.slingshot: Manually copy in from Slingshot.
	* .gitignore, bootstrap.conf, configure.ac: Adjust.
	* NEWS: Update.

	README: INSTALL is only available on release branch.
	* README.md: Fix url for Automake installed INSTALL file to point
	at release branch, where it is checked in.

	configury: don't force distribution of README.md.
	* Makefile.am (EXTRA_DIST): Don't force distribution of README.md.

	git: consolidate and simplify .gitignore.
	* bin/.gitignore, build-aux/.gitignore: Consolidate into...
	* .gitignore: ...here.  Simplify.

2013-05-18  Gary V. Vaughan  <gary@gnu.org>

	configury: support non-autotool LuaRocks installation.
	* Makefile.am, build-aux/mkrockspecs, build-aux/rockspecs.mk:
	Sync with upstream slingshot.
	* src/specl.in: Move from here...
	* lib/specl.in: ...to here.
	* configure.ac (SPECL_FALSE): Adjust.
	(AC_CONFIG_FILES): Generate a non-writeable bin/specl from
	lib/specl.in.
	(AM_INIT_AUTOMAKE): Remove `foreign` option, so
	that INSTALL is distributed, among other small nits.
	* lib/specl.in (@LUA@): Remove substituted value, and replace
	with a Bourne shell Lua search, and use that to re-execute.
	(package.path): Do not set here.
	* specs/specs.mk (specs/specl): Generate a wrapper to set
	LUA_PATH appropriately for running bin/specl in the build tree.
	(SPECL): Use it.
	* specs/specl_helper.lua (run_spec): Use it.
	* bootstrap: Create a README softlink to keep Automake happy.
	* src/.gitignore, src/specl.lua, specl/color.lua,
	specl/formatter/progress.lua, specl/formatter/report.lua,
	specl/formatter/tap.lua, specl/matchers.lua, specl/optparse.lua,
	specl/shell.lua, specl/std.lua, specl/util.lua: Move from
	here...
	* bin/.gitignore, lib/specl.lua, lib/specl/color.lua,
	lib/specl/formatter/progress.lua, lib/specl/formatter/report.lua,
	lib/specl/formatter/tap.lua, lib/specl/matchers.lua,
	lib/specl/optparse.lua, lib/specl/shell.lua, lib/specl/std.lua,
	lib/specl/util.lua: ...to here.
	* src/src.mk, specl/specl.mk: Consolidate into...
	* local.mk: ...here.
	* m4/.gitignore, specl/.gitignore, specs/.gitignore: Delete.
	* rockspec.conf (build.copy_directories): Add docs and bin.
	* NEWS, README.md: Update.

	specl: remove implicit imports misfeature.
	* src/specl.lua (initenv): No need to clobber the environment
	with everything in the table returned from any `require` in a
	spec file.
	* specs/shell_spec.yaml, specs/optparse_spec.yaml: Explicity
	import function symbols from `specl.shell` as needed.
	* NEWS: Update.

	typo: spell the matchers module name correctly in documentation.
	* docs/specl.md (Custom Matchers): The module is called `matchers`
	not `matcher`, and API calls are now fully qualified.

	typo: first "describe" in shell_spec.yaml should be "describe shell".
	* specs/shell_spec.yaml (describe specl): Rename from this...
	(describe shell): ...to this.

	typo: spell "find" correctly in a comment.
	* src/specl.lua: Spell "find" correctly in a comment.

2013-05-16  Gary V. Vaughan  <gary@gnu.org>

	specl: support new `any_of` matcher adaptor.
	* specs/matchers_spec.yaml, specs/shell_spec.yaml: Examples of
	new behaviours with `any_of` adaptor.
	* specl/matchers.lua (concat): Add a new `adaptor` parameter to
	decide between formatting a list with a final `or` or `and`
	depending on whether called from `any_of` or `all_of`.  Adjust
	all callers.
	(reformat): Likewise.
	(Matcher): Add a new `all_of?` receiver.
	(alternatives_msg): Factor out common code from `any_of?` and
	`all_of?` receivers.
	* NEWS: Update.

	refactor: rename format_any_of to format_alternatives.
	* specl/matchers.lua (Matcher.format_any_of): Rename from this...
	(Matcher.format_alternatives): ...to this. Adjust all callers.
	* docs/specl.md (Custom Matchers): Update.
	* NEWS: Update.

2013-05-13  Gary V. Vaughan  <gary@gnu.org>

	maint: post-release administrivia.
	* configure.ac (AC_INIT): Bump relese to version 8.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./local.mk (old_NEWS_hash): Auto-update.

	Release version 7
	* NEWS: Record release date.

	sanity: allow OptionParser in optparse error messages.
	* build-aux/sanity.mk: Update from slingshot.
	* build-aux/sanity-cfg.mk (sc_error_message_uppercase): Exclude
	specl/optparse.lua from check.
	(EXTRA_DIST): Add build-aux/sanity-cfg.mk.

	specl: remove reference to deleted specl.version module.
	* src/specl.lua: Remove `require "spec.version"`.
	(M._VERSION): Remove.

	util: remove reference to deleted specl.version module.
	* specl/util.lua: Remove `require "spec.version"`

	specl: much improved optparse specs, prompting some bug fixes.
	* specs/optparse_spec.yaml: Many, many more examples.
	* specl/optparse.lua (normalise): Don't add a phantom '-' to the
	end of split short options.
	(finished): Add to unrecognised list options *after* the '--' that
	got us here.
	(opterr): Add a missing period to the end of passed error message
	if necessary.
	(parse): Make unrecognised list an instance variable so that it
	can be augmented in `finished`.
	(M.new): Capture and handle `--` first, as it is a substring of
	long options and might match twice otherwise.
	Accept a comma after a long option to allow multiple spellings of
	a long option on the same line.
	Consume only one `-` prefixed word per iteration to ensure the
	handler patterns are compared against each one.

	specl: extract rather than hardcode default option specs.
	* specl/optparse.lua (set_handler): Diagnose multiple handlers.
	(new): Loop over option specification lines in the parsed help
	text, and set up default option handlers to match.

	specl: use optparse for command line option parsing.
	Make a start at replacing the current ad-hoc option parsing
	code with a more civilised module.
	* specs/optparse_specl.yaml: Write examples for the API we'd
	like to have.
	* specs/specs.mk (specl_SPECS): Add specs/optparse_specl.yaml.
	* specl/optparse.lua: New file, an option parser with a more
	civilised API.
	* specl/specl.mk (nobase_dist_lua_DATA): Add specl/optparse.lua.
	* src/specl.in: Use OptionParser instead of process_args.
	* specl/util.lua (warn, process_args): Remove.
	* specl/version.lua.in: Remove.
	* configure.ac (AC_CONFIG_FILES): Remove specl/version.lua.
	* local.mk (install_edit): Add various equivalent @PACKAGE@ etc.
	substitutions.
	(inplace_edit): Remove, it's a duplicate of $(install_edit).
	* src/src.mk (specl_inplace_edit): Start with $(install_edit).
	(docs/specl.1): Remove specl/version.lua dependency.

2013-05-12  Gary V. Vaughan  <gary@gnu.org>

	stdlib: use string_ext.escape_pattern instead of util.plain.
	* specl/std.lua (escape_pattern): Imported from upstream
	lua-stdlib.
	* specl/util.lua (plain): Remove. Re-export escape_pattern.
	Adjust all callers.

	formatters: display non-verbose inline summaries properly.
	* spec/util.lua (strip1st): Strip the 1st word, but NOT the only
	word!
	* spec/formatter/report.lua (tablulate): Use it. Reset colors
	correctly.
	(expectations): Show missing close-paren.
	* NEWS: Update.

	specl: be tolerant of spec descriptions that look like other types.
	* src/specl.lua (compile_examples): The rest of the code assumes
	that `description` is always a string.  Make it so.
	* NEWS: Update.

	matchers: be careful not to pass additional args to string.match!
	* specl/matchers.lua (matchers.contain): Wrap the returned
	values of util.plain in extra parens to discard all but the first
	return value before passing to string.match.
	* NEWS: Update.

2013-05-10  Gary V. Vaughan  <gary@gnu.org>

	docs: match <h2> anchor shortcuts with github.io generated html anchors.
	* docs/specl.md: The javascript at http://gvvaughan/github.io/specl
	rewrites h2 anchors with '-' separators.  Make sure the markdown
	shortcuts match.

2013-05-09  Gary V. Vaughan  <gary@gnu.org>

	docs: add missing docs for matchers.Matcher.format_any_of.
	* docs/specl.md (Custom Matchers): Document format_any_of
	constructor method.
	* NEWS: Update.

2013-05-09  Gary V. Vaughan  <gary@vaughan.pe>

	Merge pull request #9 from rrthomas/master
	.gitignore: add bin/

2013-05-09  Reuben Thomas  <rrt@sc3d.org>

	.gitignore: remove release-notes-* and add bin/

2013-05-09  Gary V. Vaughan  <gary@gnu.org>

	maint: post-release administrivia.
	* configure.ac (AC_INIT): Bump version number to 7.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./local.mk (old_NEWS_hash): Auto-update.

	Release version 6
	* NEWS: Record release date.

	maint: relax load error matching patterns for luajit compatibility.
	Luajit returns errors from loadstring compiled code without line
	numbers or truncated input string, so relax the match patterns
	to accept either format.
	Thanks again, Travis!
	* specs/matchers_spec.yaml (error matcher): Relax error output
	matching for luajit.
	* specl/matchers.lua (matchers.error): Use long format for any_of
	reformatter, to match format_expect.

	maint: use Lua 5.2 compatible pattern escaping.
	Lua 5.1 accepts patterns with unknown % escapes treated as
	literals, but Lua 5.2 raises an error. Factor pattern escaping
	into a function.
	Thank you, Travis!
	* specl/util.lua (plain): New function to escape only pattern
	magic characters.
	* specl/matchers.lua (escape, reformat, matchers.error)
	(matchers.contain): Use it.
	* specl/shell.lua (matchers.contain_output)
	(matchers.contain_error): Likewise.

2013-05-08  Gary V. Vaughan  <gary@gnu.org>

	docs: convert to jekyll markdown format.
	Updating the docs site is now a simple matter of copying this
	file to index.md in the gh-pages branch, and letting github do
	its magic to pick up the changes.
	* docs/specl.md: Add YAML frontmatter.
	Wrap code blocks in pygments highlight tags.
	Redo numbered headers with ## format markup for jekyll.
	Add markdown section anchors that match jekyll auto-generated
	anchors for easy cross-referencing.
	* NEWS: Update.

	refactor: untabify.
	Bring back zmacs... vi's TABy auto-indent is EVIL!
	* specl/color.lua, specl/formatter/progress.lua,
	specl/formatter/report.lua, specl/formatter/tap.lua,
	specl/matchers.lua, specl/util.lua, src/specl.lua: Untabify.

	refactor: remove `one_of` support, always use `any_of`.
	* specl/matchers.lua (Matcher["one_of?"}, Matcher.format_one_of):
	Renamed from these...
	(Matcher["any_of?"], Matcher.format_any_of): ...to these.
	Adjust all callers.
	(adaptor_error): Folded back into expect.__index.
	(expect.one_of): Remove.
	* specs/matchers_spec.yaml, specs/shell_spec.yaml: Adjust.
	* docs/specl.md: Update.
	* NEWS: Update.

	matchers: support `any_of` as an alias for `one_of`.
	* specl/matchers.lua (matchers.error): Display "no error" when no
	error message was raised, but one was expected.
	(adaptor_error): New function. Diagnose misuse of `should`
	adaptors.
	(expect): Don't overwrite full matcher name, use `matcher_root`
	to hold the matcher lookup key.
	Add support for `any_of` adaptor, mainly for use with `should_not`
	because `expect (1).should_not_be.one_of {1, 2 ,3}` reads badly.
	Call `adaptor_error` when an unsupported adaptor is called.
	* specs/matchers_spec.yaml: Lots more examples to exercise every
	permutation of matcher vs. not vs. one_of or any_of.

	refactor: move long format display from shell.lua to matchers.lua.
	* specl/matcher.lua (reformat): Rename single item reformatting
	from this...
	(_reformat): to this.
	* specl/shell.lua (concat): Move from here...
	* specl/matchers.lua (reformat): ...to here, making use of
	_reformat to simplify.
	(matchers.error): Use long format output.
	* specs/matchers_spec.yaml: Adjust.
	* specl/shell.lua: Simplify matchers accordingly.

	refactor: rename expect target parameter to actual.
	* specl/matchers.lua (expect): Rename <target> parameter to
	<actual> to match the rest of the code.

	refactor: no need to use matchers.stringify in shell.lua.
	* specl/shell.lua (matchers.exit): Use `tostring` instead of
	importing matchers.stringify into `q`.

	refactor: use Lua "%q" formatting instead of rolling our own.
	* specl/matchers.lua (q): Use Lua "%q" formatting instead of
	manually emulating it.

	matchers: support `one_of` syntax for alternatives.
	* specs/matchers_spec.yaml: Add `one_of` examples for every
	matcher.
	(it diagnoses zero alternatives with one_of): Add an example of
	getting a diagnostic from calling ...one_of {}.
	* specs/shell_spec.yaml: Add `one_of` examples for every matcher.
	* specl/matcher.lua (expect): Rename `matcher` parameter to
	`matcher_name`.
	(expect.__index:score): Factor out of returned function.
	(expect.__index): Return a functable instead of a function, with
	a `one_of` method, and a `__call` metamethod.
	(Matcher["one_of?"]): Call the matcherp predicate with every
	table entry, until one matches successfully.
	(Matcher): Add default for `format_one_of`.
	* specl/util.lua (concat): Factor pretty alternatives display
	formatting out of type_error.
	(M.QUOTED): Export a constant for self-documenting concat calls,
	using `concat (foo, util.QUOTED)`.
	(type_error): Simplify.
	* specl/matcher.lua (matchers.error, matchers.match)
	(matchers.contain): Add `format_one_of` methods.
	* specl/util.lua (type_check): Support '#table' in the typelist to
	specify a non-empty table.
	(type_error): Display nicely formatted error when an empty table
	is found when checking for '#table'.
	* specl/util.lua (map): Move above first use, in concat ().
	* docs/specl.md (Matching alternatives with `one_of`): Document it.
	* NEWS: Update.

	specl: show description and offset line for example compile errors.
	Previously, if the Lua code of any example failed, Specl would
	dump the stack, usually containing a useless list of nested
	run_context, run_examples etc etc.  We can already do a much
	better job than that... libyaml needs to provide the support
	for full and proper filewise line numbers though.
	* specs/specl_spec.yaml (it reports line of error): Example to
	demonstrate that the offset line of a compile failure is shown
	on stderr.
	* src/specl.lua (compile_example): Add a description parameter,
	and use it as a prefix for displaying the line offset for the
	failure, along with the Lua error.

	refactor: make output of failed expectations prettier.
	* specl/color.lua (shell): Rename from this...
	(match): ...to this. Adjust all callers.
	* specl/shell.lua (escape, colon): Move from here...
	* specl/matchers.lua (escape, reformat): ...to here. Adjust all
	callers.
	(M): Re-export reformat for use in specl/shell.lua.
	* specl/std.lua (prettytostring): New function, from lua-stdlib
	string_ext module.
	* specl/util.lua (prettytostring): Re-export std.prettytostring.
	* specl/matchers.lua (matcher.contain): Use prettytostring to
	show contents of failed expections with tables.
	* specs/matchers_spec.yaml, specs/shell_spec.yaml: Many new
	examples to verify prettier failed expectation output for each
	matcher.

	matchers: more powerful matcher result message API.
	* specl/matchers.lua (Matcher): Don't add spaces and commas auto-
	matically, assuming output always fits on a line, but do set
	format_actual and format_expect to provide that by default.
	Adjust all clients.
	* specl/color.lua (colormap): Add an entry for coloring shell
	output.
	* specl/shell.lua: Use new shell color, and new Matcher formatting
	API to present nicely formatted output and error stream display.

	std: add chomp from upstream lua-stdlib.
	* specl/std.lua (chomp): New function, from lua-stdlib string_ext.
	* specl/util.lua (chomp): Re-export std.chomp.

	color: use color.reset instead of "%{reset}".
	* specl/color.lua (colormap): Add reset.
	* specl/formatter/progress.lua, specl/formatter/report.lua: Use it.

	shell: add Process errout matchers.
	* specs/shell_spec.lua (output_error matcher)
	(match_error matcher, contain_error matcher): Specifications for
	new matchers to check the contents of stderr from a Process.
	* specl/shell.lua (matchers.output_error, matchers.match_error)
	(matchers.contain_error): Implement new matchers.

	specs: use unique description text in shell_spec.yaml.
	* specs/shell_spec.yaml: correctly describe the behaviour being
	checked.

	specs: test the correct matcher when tickling errors.
	* specs/shell_spec.yaml (contain_output matcher): Don't call the
	should_output matcher by mistake!

	shell: use the correct parameter name.
	* specl/shell.lua (matchers.match_output, matchers.contain_output):
	Format a correctly named parameter.

2013-05-07  Gary V. Vaughan  <gary@gnu.org>

	matchers: fix a message typo.
	* specl/matchers.lua (matchers.error): 'containing' has only one 'a'!

2013-05-05  Gary V. Vaughan  <gary@gnu.org>

	matchers: support custom matchers.
	* specl/matchers.lua (Matcher): matcher object factory.
	(matchers): Add metatable to verify assignments are objects
	from the Matcher factory.
	(matchers.equal, matchers.be, matchers.error, matchers.match)
	(matchers.contain): Rewrite with the API.
	(expect): Adjust calling convention accordingly.
	* specl/shell.lua: Rewrite shell matchers with the new API.
	* specs/spec_helper.lua (matchers.instantiate_a): Likewise.
	* docs/specl.md (Custom Matchers): New section. Document custom
	matchers API.
	* NEWS: Update.

2013-05-04  Gary V. Vaughan  <gary@gnu.org>

	util: matching a nil parameter with "any" type_check is ok!
	* specl/util.lua (type_check): Lua treats deliberate `nil`
	function arguments the same as omitted arguments, so don't raise
	an error for a `nil` argument matched against an "any" type.

	util: fix a misnamed local variable declaration.
	* specl/util.lua (type_error): Declare `expected` correctly.

	shell: support running and matching state of shell commands.
	* specs/shell_spec.yaml: Specify desired behaviour for supporting
	executing and matching results from shell commands.
	* specs/specs.mk (specl_SPECS): Add shell_spec.yaml.
	* specl/shell.lua: New file, implemnting specs above.
	(Command): A util.Object type for specifying shell commands, along
	with environment variables and input source.
	(Process): A util.Object type for recording process status and
	outputs.
	(spawn): Execute a `Command` and return a `Process`.
	* specl/specl.mk (nobase_dist_lua_DATA): Add specl/shell.lua.
	* specl/matchers.lua (q): Export `q` to ease creation of additional
	matchers in other modules.
	* specl/shell.lua (exit, output, match_output, contain_output): New
	matchers for querying the state of a `Process` from `spawn`.
	* specs/spec_helper.lua (run_spec): Rewrite as a `specl/shell.lua`
	client.
	* specs/formatters_spec.yaml, specs/matchers_spec.yaml,
	specs/specl_spec.yaml: Adjust for changes in `run_spec`.
	* src/specl.lua (specl.cmdpipe): Remove undocumented function.
	* NEWS: Update.

	util: type aware Object wrapper, and parameter type checker.
	* specl/util.lua (Object): New prototype inheriting from std.Object.
	with the addition of a "type" field.
	(typeof): Report the type of Object derived objects, or defer to
	core type() for built in types.
	(type_check): Compare types from a parameter list against valid
	type list, raising an error for a type mismatch.
	(type_error): Write a parameter type mismatch error in the style
	of Lua core function parameter type errors.

	std: import clone_rename, merge, and Object from lua-stdlib.
	* specl/std.lua (clone_rename, merge, Object): Import from
	lua-stdlib.
	(M): Export them.

	specs: nested expect calls don't need `require "specl"`.
	* specs/matchers_spec.yaml (contain matcher, match matcher):
	Remove noisy require and `specl.` table qualifiers.

	specs: copy symbols from `require "foo"` into local env.
	* src/specl.lua (initenv.require): Support consistent use of
	`require "foo"` to import foo's global symbols into the local
	environment, even when foo uses modern `return API_table` style.

2013-05-02  Gary V. Vaughan  <gary@gnu.org>

	maint: update slingshot.
	* local.mk: Move local changes from Makefile.am to here, to
	match latest slingshot usage.
	* GNUmakefile, Makeflie.am, build-aux/release.mk,
	build-aux/specl.mk, specs/specs.mk: Update form slingshot
	upstream.
	* connfigure.ac: Merge changes from slingshot.
	* m4/ax_with_prog.m4: Remove.
	* .travis.yml: Regenerate.
	* specs/formatters_spec.yaml, specs/matchers_spec.yaml,
	specs/spec_helper.lua, specs/specl_spec.yaml, src/src.mk: Update
	local specl path to new bin/specl location.

2013-05-01  Gary V. Vaughan  <gary@gnu.org>

	travis: make check in verbose mode.
	* .travis.yml: Regenerate.

	travis: let luarocks install dependencies to catch any missed ones.
	* travis.yml.in (script): Remove inessential rock preinstallations.
	Don't forget to run self-tests.
	* .travis.yml: Regenerate.

	portability: use {...} instead of table.pack (...).
	* src/specl.in (slurp): table.pack is not supported by Lua 5.1,
	so use {...} notation instead for compatibility with 5.1 and
	5.2.

	configury: remove needless subdir-objects option.
	* configure.ac (AM_INIT_AUTOMAKE): Remove subdir-objects option.
	We don't have any compiled objects at all!

	configury: remove unused auxdir macro.
	* Makefile.am (auxdir): Remove.

	maint: distribute README.md.
	* Makefile.am (EXTRA_DIST): Add README.md.
	(old_NEWS_hash): Move into bootstrap section of the file.

	maint: bump version to 6.
	* configure.ac (AC_INIT): Bump version number to 6.

	formatters: non-verbose inline report summaries.
	* specl/formatters/report.lua (expectations): Keep track of
	pending, failing and unexpectedly passing expectations, for
	display as a per-example summary in non-verbose mode.

	refactor: rearrange specl function into a more logical order.
	* src/specl.lua: Reorder function definitions.

	specl: top-level before and after support.
	* src/specl.in (slurp): Hoist document-level before and after
	functions out of the enumerated examples table.
	Prepend the current spec directory to `package.path`.
	* specs/specl_spec.yaml (describe specl before): Move from
	here...
	* src/specl.lua (run): Top level now has hoisted before and
	afters, so pass it to `run_examples` rather than `run_contexts`.
	(compile_specs): Likewise.
	* specs/spec_helper.lua (run_spec): ...to here.
	* docs/specl.md (Separating Helper Functions): Add documentation
	and a basic example.
	* NEWS: Update.

	specl: remove dead code from Lua spec format days.
	* src/specl.lua (compile_examples): No need to check for already
	compiled code now that we only support YAML specs.
	(compile_example): Simplify accordingly.

	specl: initialise spec environments earlier.
	* src/specl.lua (run_examples): initialise with local symbols
	earlier, so that they are available to before and after blocks.

	specl: require now works intuitively from a spec file.
	* specs/environmest_spec.yaml (describe environments): Change
	specifications to how require calls should affect the lookup of
	symbols they define.
	* src/specl.lua (initenv): Before deferring to the system
	loaders, try to find a required file along package.path and if
	found, load it in the context of the innermost environment.
	* docs/specl.md (Environments verses `require`): Remove.
	`require` works properly in spec files now.
	* NEWS: Update.

	specl: support multi-document YAML stream files.
	* src/specl.in (slurp): Don't discard additional documents from the
	yaml.load stream.
	* NEWS: Update.

2013-04-29  Gary V. Vaughan  <gary@gnu.org>

	maint: post-release administrivia.
	* NEWS: Add header line for next release.
	* .prev-version: Record previous version.
	* ./Makefile.am (old_NEWS_hash): Auto-update.

	Release version 5
	* NEWS: Record release date.

	specs: remove speclc_spec.yaml.
	* specs/speclc_spec.yaml: Remove. speclc was removed already.

	maint: move to slingshot release framework.
	* .autom4te.cfg: Turn off auto4mte.cache directories.
	* travis.yml.in: Continuous Integration configuration.
	* .travis.yml: Regenerate.
	* configure.ac (AC_CONFIG_FILES): Generate .travis.yml.
	* build-aux/mkrockspecs: Upgrade from Slingshot.
	* build-aux/mail, build-aux/release.mk, build-aux/rockspecs.mk,
	build-aux/sanity.mk: Slingshot release and rockspec rules.
	* specs/specs.mk, src/src.mk: Adjust.
	* GNUmakefile: Adjust, and correct typo found by sanity checks.
	* Makefile.am (release_extra_dist): Override this, because we're
	not using the huge rewritten gnulib bootstrap (there's no need
	since we don't compile anything, and only use Automake and Auto-
	conf).
	* docs/specl.md: Remove trailing whitespace.

2013-04-28  Gary V. Vaughan  <gary@gnu.org>

	AUTHORS: Fix a typo.

	mkrockspecs: rewritten to load a yaml conf.
	* rockspec.conf: New file. Specl specific rockspec configuration.
	* build-aux/mkrockspecs: Rewritten.  Works like a real program
	now, processing options and loading configuration from a
	standard './rockspec.conf' in YAML format, otherwise stdin.
	* build-aux/rockspec-template.lua: Remove. Baked into mkrockspecs
	now, instead.
	* build-aux/luarocks.mk: Move from here...
	* build-aux/rockspecs.mk: ...to here.
	($(package_rockspec), $(scm_rockspec)): Adjust for lack of
	template.
	* Makefile.am: Adjust includes for new file location.

	maint: factor out useful common make rules.
	* build-aux/luarocks.mk: New file. Factored out of...
	* Makefile.am: ...here.
	* build-aux/release.mk: New file. Factored out of...
	* GNUmakeflie: ...here.
	* build-aux/mkrockspecs: Adjust parameters to include a rockspec
	revision number as parameter 3.
	* rockspecs.lua: Move from here...
	* build-aux/rockspec-template.lua: ...to here. Interpolate new
	revision argument.
	* .travis.yml: Adjust for new location of luarocks-config.lua.
	* .gitignore, build-aux/.git-ignore: Adjust.

	maint: use NEWS based release notes for woger.
	* GNUmakeflie (release-prep-hook): Set to default release-prep
	rule.
	(announcement): New rule. Output the relevant section of NEWS.
	(release-prep): New rule. Generate a release announcement, plus
	assorted post-release book-keeping.
	(release): Use it.

	maint: refactor maintainer release rules.
	* GNUmakefile: Re-order so that the main 'release' and then 'alpha
	beta stable' rules are at the top, with everything else following
	in normal execution order.
	(release, alpha beta stable, check-in-release-branch): No need
	to tie rule commands together with '&& \' suffixes, just to
	make sure the rule aborts on the first error... make does that
	anyway!
	(news-today): Rename from this...
	(today): ...to this.
	(PREV_VERSION): No need to assign with :=, calling $(shell) runs
	immediately anyway.
	(unpack-distcheck-release): Inline to only caller.

	maint: abort release with uncommitted changes.
	* GNUmakefile (vc-diff-check): Git optimised version of the
	vc-diff-check rule from gnulib/maint.mk.
	(alpha beta stable): Use it.

	maint: only push new refspecs on release.
	* GNUmakefile (GIT_PUBLISH): Remove.
	(release): Explicitly push master, release and the new release
	tag from each.

	maint: fix VPATH builds of rockspecs.
	Now that we ship the release rockspec, it needs to work with a
	VPATH build otherwise distcheck doesn't complete.
	* build-aux/mkrockspecs: make already knows where it wants the
	output file, so just write to stdout...
	* Makefile.am: ...which is redirected to the correct location at
	make time.
	* build-aux/mkrockspecs: Move rockspec lint call from here...
	* Makefile.am: ...to here.

	configury: use configure to find sed and egrep.
	* GNUmakefile (EGREP, SED): Remove.
	* configure.ac (AC_PROG_EGREP, AC_PROG_SED): Add.

	maint: remove GNUisms from do-release-commit-and-tag.
	* build-aux/do-release-commit-and-tag: Allow non-dot version
	numbers.
	Use a nicer commit message: 'Release version vNNN'.
	(func_sort_ver): New function.  Use it instead of GNU only
	'sort -V'.
	* Makefile.am (EXTRA_DIST): Add do-release-commit-and-tag.

	maint: adopt do-release-commit-and-tag plus Make rules from gnulib.
	* build-aux/do-release-commit-and-tag: New file, from gnulib.
	* .prev-version: New file.  Previous release version number,
	required by do-release-commit-and-tag.
	* GNUmakefile: Add associated rules from gnulib GNUmakefile and
	maint.mk to improve make automated releases.
	(rockspecs): Move rockspec rules from here...
	* Makeflie.am (rockspecs): ...to here.
	(EXTRA_DIST): Add release rockspec.

	maint: use a NEWS file for user visible changes.
	* NEWS: New file.  Import RELEASE-NOTES from earlier releases.
	* .gitignore: Update.

	maint: improve the release rules for single directory process.
	* GNUmakefile: Tidy up formatting, and then simplify and fix
	release rules to always add only released files to the release
	branch.

	formatters: load unprefixed formatters from LuaRocks install.
	Now that we correctly install Specl lua files with LuaRocks, they
	are actually moved into the standard LUA_PATH automatically.  So,
	the long $(luadir)/specl/formatter/?.lua won't find them, and we
	have to augment the --formatter optarg on load failure to look in
	the right directory under the standard LUA_PATH.
	* src/src.mk (INSTALL_PATH): Remove useless formatter segment.
	* specl/version.lua.in (M["--formatter"]): If straight formatter
	load fails, try again with "specl.formatter." prefixed.

	specl: remove loadstring fallback for failed yaml load.
	* src/specl.in (slurp): Go straight to setting an error messaage
	if the yaml.load fails.

2013-04-11  Gary V. Vaughan  <gary@gnu.org>

	configury: make sure we have a src subdir in VPATH builds.
	* src/src.mk (src/specl): Make a `src` sub-directory if we don't
	already have one.

	maint: move specl and specl.lua to a new src directory.
	Previously, when setting the path to .../specl/?.lua so that
	`require "specl"` works, it also means that `require "std"` will
	find `.../specl/std.lua` instead of lua-stdlib's installed version.
	* specl/specl.in, specl/specl.lua: Move from here...
	* src/specl.in, src/specl.lua: ...to here.
	* specl/specl.mk: Move all but nobase_dist_lua_DATA from here...
	* src/src.mk: New file. ...to here.
	* specl/.gitignore: Move /specl from here...
	* src/.gitignore: New file. ...to here.
	* Makefile.am: Include new src.mk makeflie fragment.
	* specs/formatters_spec.yaml, specs/matcher_spec.yaml,
	specs/specl_spec.yaml: Adjust for new location of specl program.
	* rockspecs.lua: Make sure we install to the directory LuaRocks
	knows about.

2013-04-10  Gary V. Vaughan  <gary@gnu.org>

	configury: fix 'make distcheck'.
	* GNUmakefile (MKROCKSPECS): Spell mkrockspecs without .lua suffix.
	* specl/specl.mk (EXTRA_DIST): Likewise.
	* Makefile.am (EXTRA_DIST): Spell specl-rockspec.lua as
	rockspecs.lua.

	formatters: display elapsed wall clock time in summary.
	* specl/matchers.lua (M.stats.starttime): Call os.time instead of
	os.clock, to get wall clock time instead of CPU seconds burned.
	* specl/formatter/progress.lua (footer): Likewies when calculating
	the elapsed time to display.
	* specl/formatter/report.lua (footer): Likewise.

	specs: remove speclc and lua spec compatibility.
	There is too much magic involved in hand-writing a compatible
	Lua format specfile now.  Remove support and simplify accordingly.
	* build-aux/speclc.in: Remove.
	* specs/specs.mk: Remove speclc creation and all invocations.
	(.yaml.lua, specl_LUASPECS): Remove.

	configury: move to updated lua-stdlib machinery.
	* build-aux/mkrockspecs.lua: Remove...
	* build-aux/mkrockspecs: ...and replace with lua-stdlib master
	version.
	* specl-rockspec.lua: Move from here...
	* rockspecs.lua: ...to here.
	* GNUmakefile: Adjust accordingly.

	configury: simplify bootstrap a little.
	* bootstrap.conf: Remove.
	* bootstrap: Create ChangeLog stub. Call autoreconf. Nothing more.
	* GNUmakefile (Makefile.in): Remove unused bootstrap arguments.

	configury: remove spurious ROCKSPEC_ENV reference.
	* GNUmakefile (MKROCKSPECS): Remove unused $(ROCKSPEC_ENV).

2013-04-09  Gary V. Vaughan  <gary@gnu.org>

	docs: correct some small mistakes in README.md.
	* README.md (SPECL): Add missing 'a'.
	(Installation): Specl uses bootstrap, not autoreconf.

	configury: remove checks for C compilation.
	* configure.ac (AM_PROG_AR, AC_PROG_CC, AX_LUA_HEADERS): Remove.
	None of these are used unless we have C code to compile.

	maint: bump version to 5.
	* configure.ac (AC_INIT): Bump version number to 5.

	matchers: error matcher no longer requires reversed arguments.
	* specs/matchers_spec.yaml (error matcher): Specify all the
	behaviours of a normal argument order `should_error` based
	expectation.
	* specs/speclc_spec.yaml (it expands the expect macro): Specify
	the format of expanded expect calls.
	* build-aux/speclc.in (dump_example): Implement it.  Use a
	LuaMacro to inject a pcall into the expect expression.
	* specl-rockspec.lua (dependencies): Add luamacro >= 2.2.0.
	* specl/specl.lua (compile_example): Use the same LuaMacro to
	inject a pcall into compiled YAML chunks.
	(run_examples): Rename expect to _expect in the sandbox env to
	match the name in the expanded expect pcall.
	* specl/matchers.c (expect): New `ok` parameter to capture the
	pcall status.  Pass `ok` to the selected matcher handler.
	(matchers.error): Require arguments in the same order as the
	other matchers, plus a new `ok` parameter.
	* specs/matchers_spec.yaml: Fill in the remaining specifications
	for all currently implemnted matchers.

2013-04-08  Gary V. Vaughan  <gary@gnu.org>

	docs: reorganise and simplify.
	* README.md: Move usage documentation from here...
	* docs/specl.md: ...to here.
	* .gitignore: Adjust.

2013-04-07  Gary V. Vaughan  <gary@gnu.org>

	maint: display build badge for master branch only.
	* README.md: Don't show failing builds from experimental/release
	branch commits.

2013-04-06  Gary V. Vaughan  <gary@gnu.org>

	maint: failing tests now causes Travis CI to fail the whole build.
	* .travis.yml (after_script): Exit status here has no effect on
	failure or otherwise.  Moved from here...
	(script): ...to here, where failing tests will be reported as a
	failing build.

	specs: propagate package.path to specl subprocesses.
	* specs/specl_spec.yaml (specl.before::run_spec): Add the package.
	path to forked specl command so that it has access to ansicolors
	et.al. from the parent LUA_PATH, which may have been carefully set
	to match the interpreter by the caller.
	* specs/formatters_spec.yaml (formatters.before::run_spec): Ditto.
	Also, escape single quotes in yaml before passing to printf.

	maint: pass LUA to all make invocations for Travis CI.
	* .travis.yml (script): Pass LUA to all make invocations.

	rockspecs: fix a typo in mkrockspecs.lua script.
	* build-aux/mkrockspecs.lua: LUAROCKS has only one R in it!

	configury: fix a typo in luarocks-config.lua rule.
	* GNUmakefile (luarocks-config.lua): Come out of single-quotes to
	allow expansion of LUA_INCDIR and LUA_BINDIR.

	maint: remove remaining references to removed speclcpath.
	* build-aux/speclc.in (package.cpath): Remove.
	* specl/specl.in (package.cpath): Remove.

	configury: use check_local to pass back specs local rule.
	* specs/specs.mk (check-local): Rename from this...
	(specs-check-local): ...to this.
	(check_local): Append specs-check-local.

	maint: show verbose make check output in Travis CI logs.
	* .travis.yml (after_script): Set V=1 for verbose make output.

	maint: set local luarocks path before make check in Travis CI.
	* .travis.yml (after_script): Set local luarocks path before
	running make check.

	maint: use proven Travis CI build recipes from lyaml.
	* .travis.yml: Overhaul according to lyaml recipes.
	* GNUmakefile (luarocks-config.lua): In order to work correctly
	with a given lua interpreter for a particular luarcoks tree, make
	sure to set the appropriate luarocks variables when writing a
	luarcoks-config.lua. Also, take care to honour environment
	values for those variables at make-time, because the user probably
	knows better how their environment is set up than the generic
	make rules can!
	* README.md: Add travis build status badge markup.
	* build-aux/mkrockspecs.lua: Use the user selected luarocks
	invocation to execute luarocks lint.
	* specl-rockspec.lua (build.build_command): Pass $(LUA) as a
	configure precious variable so that latest ax-lua.m4 uses it as
	passed instead of running the hardcoded search for a lua binary.

2013-04-05  Gary V. Vaughan  <gary@gnu.org>

	maint: install correct libyaml package for Travis CI.
	* .travis.yal (install): spell libyaml with a -dev on the end!

	maint: install libyaml for Travis CI.
	* .travis.yml (install): libyaml is a build requirement.

	maint: install requisite luarocks for Travis CI.
	* .travis.yml (script): Install ansicolors and lyaml.

	maint: install help2man for travis.
	* .travis.yml (install): help2man is a build requirement.

	maint: relax autoconf requirement to v2.68.
	* configure.ac (AC_INIT): 2.68 is new enough, and is the newest
	version available by default on Travis CI server.

	maint: use travis CI server.
	* .travis.yml: New file. Travis CI directives.

2013-04-03  Gary V. Vaughan  <gary@gnu.org>

	maint: update TODO.
	* TODO.yaml (pending support): Remove.  Pending is fully
	implemented now.
	(report line numbers of pending and failed examples): New entry.

	specs: remove nonsense pending with before examples.
	A spec that contains before/after actions is not empty, so it
	is non-sensical to expect that non-empty specification to be
	pending by default, even though it has no non-reserved word
	examples.
	* specs/specl_spec.yaml (it is pending with a lone before)
	(it is pending with a lone after, it is pending with before and)
	(after): Remove.

2013-03-29  Gary V. Vaughan  <gary@gnu.org>

	docs: clarify documentation of custom formatters.
	* README.md (Custom Formatters): Edit for clarity and accuracy.

	docs: document string argument to pending call.
	* README.md (Pending Examples): Document string argument to
	pending call.

2013-03-24  Gary V. Vaughan  <gary@gnu.org>

	matchers: report pending argument for pending passes.
	* specl/matchers.lua (M.pending): Accept and store an optional
	argument.
	(M.expect): Copy pending argument to expectations status table.
	* specs/specl_spec.yaml: Remove pending call from newly passing
	example.
	* specl/formatters/progress.lua (expectations): If a value was
	stored in the pending field, display it in the pending report.
	* specl/formatters/report.lua (expectations): Likewise.

2013-03-22  Gary V. Vaughan  <gary@gnu.org>

	formatters: new TODO items for pending behaviour as pending specs.
	* specs/specl_spec.yaml: New TODO items for pending behaviour as
	pending specs.

	matchers: diagnose passing expectations in pending examples.
	* specs/specl_spec.yaml: Rearrange slightly to make room for a
	new specification for unexpected passes in pending examples.
	* README.md (Pending Examples): Document reporting of unexpected
	passes with the built in formatters.
	(Custom Formatters): Document changes to the expectations API
	needed to support this.
	* specl/colors.lua (colormap.warn, colormap.strong): New colors
	for unexpected pass reporting.
	* specl/formatter/progress.lua (expectations): Return unexpected
	pass report strings, and display a `?` in the progress bar.
	(footer): Report unexpected passes in the summaries.
	* specl/formatter/report.lua (expectations, footer): Likewise,
	except of course there is no progress bar with this formatter,
	so display the unexpected pass report in the main output when
	verbose is set.

	formatters: handle 0 expectations gracefully.
	* specs/specl_spec.yaml: Specify "No expectations" behaviour.
	* specl/formatter/report.lua (footer): If expectations was never
	called, then report will be nil; so guard report dereferencing to
	avoid a crash.
	* specl/formatter/progress.lua (footer): Likewise.
	Also, change summary to say "No expectations met" when none were
	given.

2013-03-20  Gary V. Vaughan  <gary@gnu.org>

	maint: bump version to 4.
	* configure.ac (AC_INIT): Bump version number to 4.

	specl: report YAML compilation failures.
	* specl/specl.lua (compile_example): Report loadstring error
	messages.
	Add newline before function closing `end` incase the previous line
	ends in a comment.
	* TODO.yaml: Remove fixed item.

	refactor: move color selection to specl/color.lua.
	To provide a more uniform use of color between built in formatters,
	factor out hard-coded colors and look them up by content type.
	* specl/color (colormap): Tabulate names of some useful colors, and
	return it, defaulting to underlining unknown color lookups.
	* specl/formatters/progress.lua, specl/formatters/report.lua: Use
	it.

	formatters: always show fail summary, use verbose for inline.
	You shouldn't need to specify `--verbose` on the command line to
	get a summary of failing and pending examples, show them all the
	time by default.  The `--verbose` switch now enables additional
	inline reporting, where that makes sense.
	* specl/formatter/progress.lua (footer): Always show summaries.
	* specl/formatter/report.lua (footer): LIkewise.
	(expectations): Show additional inline pending and failing reports
	in verbose mode.
	* GNUmakefile (specl_verbose_0): With V=1 use report formatter in
	verbose mode, otherwise default formatter.

	formatters: use table accumulators to collect pending reports.
	* specl/formatter/progress.lua (expectations): Split returned
	value into a `pend` and `fail` reports.
	(footer): Display `pend` and `fail` summaries in verbose mode.
	* specl/formatter/report.lua (expectations, footer): Likewise.
	* specl/formatter/tap.lua (expectations): Display pending reports
	inline as TAP comments.

	formatters: provide a richer accumulator API for custom formatters.
	* README.md (Custom Formatters): Document the richer API.
	* specs/formatters_spec.yaml: New file. Specify accumulator API
	behaviour.
	* specs/specs.mk (specl_SPECS): Add specs/formatters_spec.yaml.
	(specl_LUASPECS): Add specs/formatters_spec.lua.
	* specl/specl.lua (accumulator): Implement it.

2013-03-19  Gary V. Vaughan  <gary@gnu.org>

	maint: adjust output from compiled Lua spec files.
	Since we effectively run every specification twice to make sure
	support for Lua specs isn't broken, tweak the descriptions of
	compiled specs so we can tell them apart in failure summaries.
	* specs/specs.mk (.yaml.lua): Inject '(Lua spec)' into top-level
	describe entries as compiled specs are written to disk.

	formatters: tweak color output for report formatter.
	* specl/formatter/report.lua (footer): Use blue instead of red
	for the failing report header output.

	maint: remove completed TODO items.
	* TODO.yaml: Remove completed TODO items.

	matchers: report an empty example definition as a pending example.
	* README.md (Pending Examples): Update to document empty example
	definitions as denoting a pending example.
	* specs/specl_spec.yaml: Remove pending status for empty example
	definition specifications.
	* specl/specl.lua (compile_examples): Replace any empty definition
	with a call to `pending` before compiling.
	* specs/speclc_spec.lua: New file. Specify that the compiler must
	produce a Lua format spec file with a call to `pending` injected
	into otherwise empty example definitions.
	* specs/specs.mk (specl_SPECS): Add specs/speclc_spec.yaml.
	(specl_LUASPECS): Add specs/speclc_spec.lua.
	* build-aux/speclc.in (dump_example): Replace otherwise empty
	example definitions with a call to `pending`.

	matchers: preliminary support for pending expectations.
	* README.md: Document required behaviour of pending examples.
	Edit the surrounding text so that the new section fits in to
	the narrative logically.
	* specs/specl_spec.yaml: New examples to show how pending
	examples should work.  Some are still pending!
	* specl/specl.lua (run_examples): Change the formatters API
	slightly, because we don't want to have already displayed an
	example description on the previous line before we know whether
	the description is for a still pending example.
	* specl/formatter/progress.lua (expectations): Decode the new
	status parameter table to display pending examples as '*'.
	* specl/formatter/report.lua (tabulate): Make a suitably
	colorful output table element.  Factored out of spec.
	(spec): Adjust.
	(example): Remove.
	(expectations): Decode the new status pararameter table to show
	whether the whole example is pending, or that the expectations
	are specifying currently unimplemented behaviour.
	* spelc/formatter/tap.lua (expectations): Likewise.
	* specl/formatter/progress.lua (footer): Show pending examples
	in statistics.
	(M): Remove unused example entry point.
	* specl/formatter/report.lua, specl/formatter/tap.lua (footer)
	(M): Likewise.
	* specl/matchers.lua (M.init): New entry point to prepare for
	a new block of expectations, that keep track of pending status.
	(M.status): New entry point. Return results after a block of
	expectations have run.
	* specl/specl.lua (run_examples): Use them instead of hard-
	coding.
	* specl/matchers.lua (M.stats): Add pend counter.
	(M.expect): Don't try to match an expectation for a pending
	example, or count it's status.
	(M.pending): New entry point, put the current expectation block
	in pending mode, and increment pend counter.

	docs: re-organise and edit README.md to make way for pending docs.
	* README.md (YAML): Split out from the Specifications section.
	Don't list the quirks at the end, explain them in the main text
	of this section.
	Renumber following sections accordingly.
	(Contexts): Introduce an example right away.
	(Pending Examples): Pending.
	(Custom Formatters): Describe API changes necessary to support
	display of pending expectations and examples.

	refactor: move command pipe managment into environment sandbox.
	Generalize the output and exit status capturing functions into
	the outermost environment sandbox, where it can be used by any
	spec-files.
	* specs/specl_spec.yaml (exit_status, capture_output): Refactored
	from here...
	* specl/specl.lua (env.spec.cmdpipe): ...to here.
	* specs/specl_spec.yaml (run_spec): New helper function, wrapping
	spec.cmdpipe.
	Adjust all callers.

	matchers: use util.tostring to display tables for diagnostics.
	* specl/matchers.lua: Import specl.util.
	(q): Use util.tostring so that tables output by failed expectations
	are legible.

	refactor: move non-lua-stdlib functions out of specl.std.
	* AUTHORS: Credit Reuben Thomas for the contents of
	specl/std.lua.
	* specl/std.lua: Change copyright header to refrect the correct
	copyright and license terms of the code in this file.
	(prog, warn, process_args): Move from here...
	* specl/util.lua (prog, warn, process_args): ...to here.
	* specl/std.lua (metatable, strbuf,clone, metamethod, render)
	(tostring): New functions.  Copied from, or trivial reworkings of
	code from lua-stdlib.
	(M): Update accordingly.
	* specl/util.lua: Import specl.std.
	(M.process_files, M.slurp, M.tostring): Re-export functions from
	specl.std.
	* specl/specl.in: Import those APIs from specl.util instead of
	specl.std.

2013-03-18  Gary V. Vaughan  <gary@gnu.org>

	refactor: use canonical util.nop everywhere.
	* specl/specl.lua (nop): Remove.
	(compile_example): Use util.nop.

	specl: improve --help output.
	* specl/version.lua.in (M["--help"]): Improve --help output
	formatting, and correct an inaccuracy in --verbose description.

	docs: recommend --help for more info, -h was a typo.
	* README.md (Command Line): Fix a typo.

	refactor: encapsulate coloring into util.princ.
	* specl/util.lua: Require "specl.color".
	(M.princ, M.writc): Wrap ansicolor printing with princ, and
	io.stdout:write with writc.
	* specl/formatter/progress.lua, specl/formatter/report.lua:
	Require "specl.util" instead of "specl.color".
	Use princ and writc wrappers.

	specl: -v doesn't change formatter, support -f for that.
	* README.md (Command Line): Document change of meaning for
	`--verbose`.
	* specl/version.lua.in (M.opts): Default verbose to false.
	(M["--help"]): Document changes to command line interface.
	(M["--verbose"]): Don't change formatter, set verbose mode.
	(M["-f"]): An alias for `--formatter`.
	* specl/formatter/progress.lua, specl/formatter/report.lua
	(footer): Only show the failure summary in verbose mode.
	* GNUmakefile (specl_verbose_0): Pass `--verbose` to get failure
	summary.
	* specl/std.lua (process_args): Support short option arguments.
	(specl_verbose_1): Additionally, switch to the report formatter.

	rockspecs: fix a typo, and remove unused configure flags.
	* specl-rockspec.lua (dependencies): spell ansicolors correctly.
	(build.build_command): Remove unused YAML flags.

	configury: distribute specl/util.lua.
	* specl/specl.mk (nobase_dist_lua_DATA): Add specl/util.lua.

	refactor: move common formatter helpers into specl.util module.
	* specl/util.lua (map, strip1st, indent, nop): New file.
	* specl/formatter/progress.lua, specl/formatter/report.lua,
	specl/formatter/tap.lua: Import those functions from specl.util
	and remove local copies.
	* specl/formatter/progress.lua (expectations, footer): Display
	a failed expectation summary in the footer output.

	formatters: redisplay failed test reports in output footer.
	* README.md (Custom Formatters): Document accumulator feature of
	new custom formatter API.
	* specl/formatter/report.lua (map, strip1st): New functions,
	copied from tap.lua.
	(expectations): Return a separate but unindented concatenated
	string of all failure reports.
	(footer): Summarize failure reports.
	* specl/specl.lua (accumulator): New function to accumulate a
	string from pieces.
	(run_contexts, run_examples): Pass returned strings from formatter
	API calls to accumulator.
	(run): Initialise the formatter accumulated string, and then pass
	the result to formatter.footer.

	docs: many fine improvements to README.md.
	* README.md: Proof read the file carefully, and make corrections
	for grammar, spelling and clarity.

	docs: improve installation instructions.
	* README.md (Installation): New section.  Describe installation
	options.  Renumber following sections.

	refactor: generalize std.lua, move Specl specifics to version.lua.
	* specl/std.lua (optarg): Remove.
	(process_args): Remove Specl specific option processing, in favor
	of tabulated general option processor.
	* specl/version.lua.in (M): Tabulate option processing in terms
	of handler functions.
	(M.opts): Default option settings.

	refactor: simplify option processing.
	* specl/version.lua.in (M.PACKAGE, M.PACKAGE_NAME)
	(M.PACKAGE_BUGREPORT, M.VERSION, M.Name, M.program)
	(M.COPYRIGHT_STRING, M.COPYRIGHT_NOTICE, M.BUGREPORT_NOTICE):
	Remove.
	* specl/std.lua (prog.version, prog.usage): Move from here...
	* specl/version.lua.in (M.version, M.usage): ...to here, and
	simplify.

	formatters: color output on ANSI terminals.
	* specl-rockspec.lua (dependencies): Add ansicolor.
	* specl/std.lua (prog.usage): Describe new --color option.
	(optarg): Factor out extraction of argument options after '='.
	(process_args): Use it for --formatter processing.
	Add support for --color option.
	* specl/specl.in (opts): Make global, for visibility in color.lua.
	* specl/color.lua (color): New file.  Enable or disable colored
	output according to opts.color setting.
	* specl/specl.mk (nobase_dist_lua_DATA): Add color.lua.
	* specs/specl_spec.yaml: Add `--color=no` to specl invocations for
	saner output comparison checks.
	* specl/formatter/progress.lua: Color output when --color=no was
	not specified.
	* specl/formatter/report.lua: Likewise.

2013-03-17  Gary V. Vaughan  <gary@gnu.org>

	yaml: spun off into a separate project.
	Rather than ship and build our own yaml binding, spin it off to
	http://github.com/gvvaughan/lyaml and depend on a new luarock
	built from that.
	* yaml/yaml.mk: Remove.
	* Makefile.am: Adjust.
	* specl/specl.mk (SPECL_CPATH): Remove.
	(specl_install_edit, specl_inplace_edit): Adjust.
	(specl_specl_DEPS): Remove yaml/lyaml.la.
	* yaml/lua52compat.h, yaml/lyaml.c: Remove.
	* configure.ac (LT_INIT): Remove, along with supporting configury.
	(AC_CONFIG_HEADERS): Remove.
	* specl-rockspec.lua (external_dependencies.YAML): Remove.
	(dependencies): Add lyaml.

	rockspecs: remove debug line.
	* build-aux/mkrockspecs.lua: Remove left-over debug line.

	maint: add AUTHORS file.
	* AUTHORS: New file.

	formatters: strip 1st word from descriptions in formatters.
	* specl/specl.lua (run_contexts, run_examples): Don't strip 1st
	words, just pass full description tables to formatters.
	* specl/formatters/progress.lua (spec, example): Remove.
	* specl/formatters/tap.lua (header, spec, example): Remove.
	(map, strip1st): Strip 1st word from each element of a table.
	* specl/formatters/progress.lua (expectations): Rename `desc`
	parameter to `descriptions`.
	* specl/formatters/report.lua (indent, spec, example)
	(expectations): Likewise.
	* specl/formatters/tap.lua (expectations): Likewise.
	* specl/formatters/report.lua (spec, example): Strip 1st word
	from descriptions before printing.
	* specl/formatters/tap.lua (expectations): Likewise.
	* specl/formatters/progress.lua (nop): Null operation function.
	(M): Use nop as appropriate.
	* specl/formatters/tap.lua (nop, M): Likewise.

	specl: don't inject a Lua return keyword into a YAML spec.
	Assume specs are written in YAML, and only fallback to legacy
	Lua format if that fails.
	* specl/specl.in (slurp): Try yaml.load first, and loadstring
	with an injected return keyword only if yaml.load failed.
	Reported by Franois Perrad.

2013-03-16  Gary V. Vaughan  <gary@gnu.org>

	docs: document improved custom formatter API.
	* README.md (Custom Formatters): Document improved custom formatter
	API from Franois Perrad.

	formatters: support loading builtin formatters by basename.
	* specs/specl_spec.yaml: New specification for using a custom
	formatter by basename on the command line.
	* specl/specl.mk (specl_install_edit): Do as the documentation
	states, and allow loading of builtin formatters with a simple
	`--formatter=tap` command line option.

2013-03-16  Gary V. Vaughan  <gary@vaughan.pe>

	Merge pull request #3 from fperrad/tap
	TAP formatter

2013-03-16  Francois Perrad  <francois.perrad@gadz.org>

	add TAP formatter

	refactor formatter
	replace the string 'indent' by the array 'desc'

2013-03-15  Gary V. Vaughan  <gary@gnu.org>

	docs: be more relaxed about literal block markers.
	* README.md: Improve description of when `|' is necessary, and
	remove them from embedded examples.
	* specs/environment_spec.yaml, specs/matchers_spec.yaml,
	specs/specl_spec.yaml: Remove unnecessary `|' markers and use
	fewer new-lines.

	specs: specify behaviour of require calls in examples.
	* specs/environment_spec.yaml (when requiring a module): New
	specifications for use of require.
	* README.md (Environments versus `require`): Document that extra
	care is required when testing behaviour of required modules.

	environments: intercept load* calls in spec-files.
	Make sure that side-effects from executing a load* function
	variant in a spec-file example occur in the example environment.
	* specl/specl.in (clone): Remove.
	(sandbox): No need for a deep clone, because Specl is hygienic
	and puts everything in locals or the global specl table *after*
	the sandbox is created.
	* specl/specl.lua (run): Save references to the unwrapped core
	load* functions...
	(initenv): ...so they can be intercepted and wrapped specifically
	for each environment table.
	(run_examples): Call initenv() before running an example.
	* specs/environment_spec.yaml: A slew of examples to verify
	correct symbol access with load* variants.

2013-03-14  Gary V. Vaughan  <gary@gnu.org>

	specl: isolate specl modules into their own namespace.
	To avoid potential clashes with modules along the load-path of a
	specl client, refer to specl's own modules using the specl name-
	space.
	* specl/specl.in: Use `require "specl.std"`.  specl.lua is
	already in the specl namespace, so no need to prefix that one.
	* specl/specl.lua: Likewise for specl modules required here.
	* specl/std.lua: Likewise.
	* specl/specl.mk (SPECL_PATH): Support prefixed requires in the
	build tree.
	(specl_install_edit): Likewise, for the install tree.
	(nobase_dist_lua_DATA): Move specl/specl.lua from here...
	(dist_lua_DATA): ...to here, so that specl.lua is not installed
	into the specl subdirectory, and `require "specl"` works
	correctly.

2013-03-13  Gary V. Vaughan  <gary@gnu.org>

	specs: make sure Lua specs are compiled correctly.
	Using '$^' passes all dependencies as a single non-existent
	filename - garbage in, garbage out.
	* specs/specs.mk (.yaml.lua): Use '$<', which passes the correct
	yaml input for compilation to Lua.

	configury: move gmake-only SPECL_OPTS rules to GNUmakefile.
	* specs/specs.mk (SPECL_OPTS, specl_verbose_, specl_verbose_0)
	(specl_verbose_1): Move from here...
	* GNUmakefile: ..to here.

	specl: implement our own getopt with no dependencies.
	Lua stdlib getopt.lua ends up pulling in several more stdlib
	modules, which we don't want if specl is to be useful as the
	BDD tool for stdlib itself.  And after removing getopt, it turns
	out we still had a handful of hidden dependencies on stdlib
	ext module behaviours.
	* specl/std/getopt.lua: Remove.
	* specl/std.lua: Implement our own slurp, warn, process_args and
	process_files functions.
	* specl/specl.in (prog): Move from here...
	* specl/std.lua (prog): ...to here.
	* specl/specl.in: Simplify with the help of bespoke std.lua.
	* specl/specl.mk (nobase_dist_lua_DATA): Adjust.
	* build-aux/speclc.in: Use our mini std.lua.
	(reserved): Use a table with true valued keys. instead of a std
	set. Adjust all callers.
	* specl/matchers.lua (M): Inject public APIs as we go, rather
	than relying on stdlib table.merge to assemble the M table.
	* specl/spel.lua (M): Likewise.
	* specs/specl_spec.yaml (specl): Don't rely on stdlib nil concat
	behaviour.

2013-03-12  Gary V. Vaughan  <gary@gnu.org>

	specl: break dependency on std sets.
	Being intertwined with lua-stdlib makes it hard to use specl for
	the std specs.
	* specl/specl.lua (reserved): Use a table with true valued keys,
	instead of a std set.

2013-03-10  Gary V. Vaughan  <gary@gnu.org>

	environments: make runner environments more robust.
	Make sure each nested example block uses the same environment
	for before, definition and after calls, and passes the correctly
	initialised environment (after befores have run) to nested
	contexts.
	* specs/environment_spec.yaml: Uncomment previously failing
	examples.
	* specl/specl.in (clone): New function, copied from stdlib
	tree.lua.
	(sandbox): Before loading anything, make a deep copy of the
	pristine global environment to use as a sandbox for running
	examples.
	* specl/specl.lua (run): Add an env parameter, and pass that to
	run_contexts.
	(run_contexts): Remove dead code.
	(run_examples): Set up the sandbox for the current example group
	from the env parameter, and use it for each example before,
	definition and after block.
	Fix a bug that passed the wrong environment to recursive
	run_context calls.

2013-03-10  Reuben Thomas  <rrt@sc3d.org>

	configury: ensure lua includes match lua binary version.
	* configure.ac (AX_LUA_HEADERS): Invoke this macro.

	configury: AC_CONFIG_MACRO_DIRS is not released yet!
	* configure.ac (AC_CONFIG_MACRO_DIRS): Replace this...
	(AC_CONFIG_MACRO_DIR): ...with the buggy old API call.

	specl: factor away getopt.Option constructor.
	* specl/std/getopt.lua: Update to latest upstream.
	* specl/specl.in (prog.options): Use bare tables, per stdlib-34
	API.

2013-03-09  Gary V. Vaughan  <gary@gnu.org>

	docs: document current dir removal for custom formatters.
	* README.md (Command Line): Make note of the fact that loading
	custom formatters from the current directory requires a little
	extra path munging in the environment.

	specl: break dependency on lua-stdlib.
	* specl/matchers.lua: Do not require std.
	* specl/std/getopt.lua: A copy of stdlib-33 getopt.lua.
	* specl/specl.in: Require local copy of getopt instead of all of
	stdlib.
	* specl/specl.mk (nobase_dist_lua_DATA): Add specl/std/getopt.lua.
	* specl-rockspec.lua (dependencies): Remove std dependency.
	* TODO.yaml: Remove completed TODO item.

	TODO: more TODO items.
	* TODO.yaml: Put some new pressing TODO items at the top of the list.

	specl: support --formatter=FILE option.
	* specl/specl.in (prog): Add new formatter option.
	If formatter was passed, try to load the passed formatter.
	Pass the eventual formatter to specl.run.
	* specs/specl_spec.yaml (when using a custom formatter): Check
	that custom formatters are called correctly.
	* README.md (Custom Formatters): New section describing how to
	write a custom formatter.

	maint: support 'make check V=1' and 'SPECL_OPTS=-v make check'
	* specs/specs.mk (SPECL_OPTS): Unless set in the environment already,
	pass -v to specl according to whether or not V=1 was given to make.
	(check-local): Use it.

	formatters: factor out into separate modules.
	For Automake to install subdirectories correctly with a _DATA
	primary, the nobase_ prefix only works when the source and
	destination directories have the same name, so we have to rename
	'src' to 'specl' in order that the new specl/formatters/*.lua
	sources are installed correctly.
	* specl/specl.mk (dist_pkglua_DATA): Rename from this...
	(nobase_dist_lua_DATA): ...to this.
	* src/.gitignore, src/matchers.lua, src/specl.in, src/specl.lua,
	src/specl.mk, src/version.lua.in: Move from here...
	* specl/.gitignore, specl/matchers.lua, specl/specl.in,
	specl/specl.lua, specl/specl.mk, specl/version.lua.in: ...to here.
	* Makefile.am, configure.ac, specl/specl.mk, specs/specs.mk,
	specs/specl_spec.yaml: Adjust.
	* specl/specl.lua (M): Remove progress and report.
	(progress): Move from here...
	* specl/formatter/progress.lua: New file.  ...to here.
	* specl/specl.lua (report): Move from here...
	* specl/formatter/report.lua: New file.  ...to here.
	* specl/matchers.lua (expectations, stats): Initialise inside the
	module table.
	(expect): Update inside the module table.
	(M): Adjust.
	* specl/specl.in: Load and pass report formatter to specl.run()
	on demand.
	* specl/specl.mk (nobase_dist_lua_DATA): Add
	specl/formatter/progress.lua and specl/formatter/report.lua.
	(specl_specl_DEPS): Adjust.

	matchers: factor out into a separate module.
	Get rid of ugly global stats and expectations place holders, and
	factor matchers out into their own module.
	* src/specl.lua (objcmp, q, matchers, expect, expectations)
	(stats): Move from here...
	* src/matchers.lua (objcmp, q, M.matchers, M.expect, M.expectations)
	(M.stats): ...to here.
	* src/specl.lua (run_examples, run): Adjust.
	(M): Remove matchers.
	* src/specl.mk (dist_pkglua_DATA): Add src/matchers.lua.

	specl: set specl._VERSION correctly.
	* src/specl.lua (version): require version.lua.
	(M._VERSION): Set from version table.

	maint: ignore .DS_Store files.
	* .gitignore: Add .DS_Store.

	specl: ensure lyaml is built before running specl.
	Parallel make gets carried away without a full and complete
	dependency graph, so be sure to specify that specl doesn't work
	until lyaml.la is built.
	* src/specl.mk (src_specl_DEPS): Add yaml/lyaml.la.
	Reported by Reuben Thomas at https://github.com/gvvaughan/specl/issues/1.

2013-03-07  Gary V. Vaughan  <gary@gnu.org>

	maint: bump version to 3.
	* configure.ac (AC_INIT): Bump version number to 3.

2013-03-06  Gary V. Vaughan  <gary@gnu.org>

	rockspecs: correct source.url and source.dir for github.
	* specl-rockspec.lua (source.url, source.dir): Remove '-1' suffix.

	maint: distribute README.md.
	* Makefile.am (EXTRA_DIST): Add README.md.

	rockspecs: build from github zip file.
	Rather than require git clone to checkout the source tree at
	rockspec install time, download the automatic github zip file.
	* specl-rockspec.lua (source): Extrapolate zip file location.
	(source.branch): Remove.
	* src/specl.mk (specl_install_edit): Use pkgluadir and libdir
	to match luarocks installation dirs.
	* yaml/yaml.mk (luaexec_LTLIBRARIES): Rename from this...
	(lib_LTLIBRARIES): ...to this, or luarocks doubles up the
	installation subdirectories to lua/5.x/lua/5.x!

	rockspecs: fix missing quote in build_command.
	* specl-rockspec.lua (build.build_command): Add missing quote.

	maint: don't distribute compiled Lua specs.
	* specs/specs.mk (SPECLC): Path to speclc program.
	(specl_SPECS): Remove Lua spec files.
	(specl_LUASPECS): List Lua spec files.
	(.yaml.lua): Make sure there is a specs dir in the build tree.
	(DISTCLEANFILES): Remove generated lua spec files.

	maint: distribute specl-rockspec.lua.
	* Makefile.am (EXTRA_DIST): Add specl-rockspec.lua.

	specl: always pass a (small) number to os.exit().
	os.exit in Lua 5.1 doesn't accept a boolean, so we pass it 1 if
	there are any failures, otherwise 0.
	* src/specl.lua (run): Return a small integer suitable for os.exit.
	* src/specl.in: Remove completed TODO.

	specl: use loadstring for Lua 5.1 compatibility.
	* src/specl.lua (loadstring): If loadstring is not defined, then
	this must be Lua 5.2, so define a loadstring work-a-like around
	load.
	* src/specl.in (slurp): Use loadstring, either from Lua 5.1 core,
	or the wrapper above.

2013-02-28  Gary V. Vaughan  <gary@gnu.org>

	maint: more TODO items.
	* TODO.yaml: New items.

	specl: support continued (undocumented!) specl-1 _spec.lua specs.
	* src/specl.in (slurp): First try to load as pure Lua, and if
	that fails, fall back to the YAML loader before erroring.
	* src/specl.lua (copile_specs, compile_examples, compile_example):
	Factor out compilation phase for YAML specs.
	* build-aux/speclc.in: New file. %_spec.yaml to %_spec.lua
	compiler (requires lyaml!).
	* specs/specs.mk (build-aux/speclc): Build it from speclc.in.
	(.yaml.lua): New rule to compile all yaml specs to lua to make
	sure Lua specs continue to be fully functional.
	(specl_SPECS): Add lua specs.
	* build-aux/.gitignore: Add speclc.
	* specs/environment_spec.yaml: Comment out a spec that fails
	when loaded as a lua spec, but passes as a yaml spec :-?
	* TODO.yaml: Remove done items.

	maint: keep track of TODO items in the repository.
	* TODO.yaml: New file. List pending TODO items.

	yaml: compile lua fragments on the fly instead of requiring `!lua`.
	* yaml/lyaml.c (load_scalar): Remove `!lua` precompiling support.
	* src/specl.lua (compile_example): New function to compile an
	example.
	(run_examples): Use it when encountering an uncompiled example.
	* specs/environment_spec.yaml, specs/matchers_spec.yaml,
	specs/specl_spec.yaml: Remove all `!lua` tags.
	* specs/specl_spec.yaml: New expectations for yaml specs on CLI
	standard input.
	* README.md: Update documentation. Particularly removing the
	notes about dealing with quirks of `!lua`.

	specs: specify exit statuses
	* specs/specl_spec.yaml (describe specl): New examples to specify
	exit status of specl.
	(describe matchers): Move everything else from here...
	* specs/matchers_spec.yaml: ...to here.

	maint: GNUmakefile improvements.
	* GNUmakefile (unpack-distcheck-release): Be sure to rebuild rockspecs.
	(check-in-release): Commit all unpacked files on the release branch.

	rockspecs: allow arbitrary revision numbers.
	* build-aux/mkrockspecs.lua (qualified_version): New value.
	Extract this from the template, in case this is not a revision -1
	rockspec.

2013-02-26  Gary V. Vaughan  <gary@gnu.org>

	specl: return non-zero exit status when there are failing specs.
	* src/specl.lua (run): Return false when there are failing tests.

	maint: call woger properly at release time.
	* GNUmakefile (WOGER_ENV): Lua environment settings for extracting
	woger release variables.
	(WOGER_OUT): Lua call for feretting out the rockspec file
	settings used by woger.
	(release): Fully populate all the fields needed to make a correct
	woger release of Specl.

2013-02-25  Gary V. Vaughan  <gary@gnu.org>

	docs: update README to document new YAML syntax spec files.
	* README.md: Updated to document new YAML syntax spec files.

	configury: user-overridable search for install libyaml.
	* configure.ac (AC_CHECK_HEADERS): Look for yaml.h.
	(AC_SEARCH_LIBS): Abort with an error if libyaml is not found.
	* yaml/yaml.mk (yaml_lyaml_la_LIBADD): Remove hardcoded -lyaml.
	* specl-rockspec.lua (external_dependencies): Add yaml.
	(build.build_command): Pass through YAML options from rockspec
	make command.

	specs: factor out specification checking to a separate makefile.
	* src/specl.mk (Specs): Move this section from here...
	* specs/specs.mk: New file.  ...to here.
	* Makefile.am: Include specs/specs.mk.

	specs: a minimal environment sharing spec.
	* specs/environment_spec.yaml: New file. Ensure before, after,
	examples in the same scope share execution environments
	correctly.
	* src/specl.mk (specl_SPECS): New macro. List all spec files.
	(EXTRA_DIST): Adjust.
	(check-local): Add dependencies. Remove unnecessary environment
	setting. Pass a static list of spec files.

	specl: read yaml format spec files.
	* yaml/lua52compat.h, yaml/yaml.c: New files.  Sources for yaml
	module.
	* yaml/yaml.mk: New file. Build yaml module.
	* Makefile.am: Include it.
	(lib_LTLIBRARIES): Initialise.
	* configure.ac (AC_INIT): Bump version to 2.
	(AM_INIT_AUTOMAKE): Use subdir-objects.
	(LT_PREREQ, LT_INIT): Add libtool setup.
	(AC_PROG_CC, AC_HEADER_STDC): Add C compiler setup.
	(AC_CONFIG_HEADERS): Make config.h.
	* specs/specl_spec.lua: Move from here...
	* specs/specl_spec.yaml: ...to here. Reformat to yaml.
	* src/specl.mk (check-local): Move from here...
	* specs/specs.mk: New file. ...to here.
	* src/specl.lua (run_examples): YAML doesn't provide a pleasant
	way to format reserved descriptions (before, after) outside of
	the ordered list of actual examples, so we have to make a first
	pass over the list to extract them, and then be careful not to
	run them again in the main loop.

	specl: fix --version and --help formatting with stdlib-33 getopt.
	* src/specl.in (prog.version): Separate out copyright notice...
	(prog.copyright): ...to here.
	(prog.description): Latest stdlib getopt doesn't need double
	newline paragraph separators.
	* src/version.lua.in (M.COPYRIGHT_NOTICE): Rejustify slightly.
	Point to gnu licenses webpage rather than COPYING file, which
	might have been lost during installation!

	rockspecs: add dependency on latest stdlib rock.
	* specl-rockspec.lua (dependencies): Add stdlib.

	maint: don't check release tarball file in on release branch.
	* .gitignore: Ignore specl-*.tar.gz.
	* build-aux/.gitignore: Don't ignore manually imported
	gitlog-to-changelog.

	specl: update to cleaner stdlib-33 getopt formats.
	* src/version.lua.in (M.COPYRIGHT_NOTICE): Remove stray '\n'.
	* src/specl.in (prog): No longer needs to be a magic global.
	(options): Ditto.  Move from here...
	(prog.options): ...to here.
	(prog.purpose, prog.description): Reword to match rockspec.
	(prog.version): Add this for --version output.
	(prog.banner): Remove.

	maint: fix typos in GNUmakefile.
	* GNUmakefile (unpack-distcheck-release): Add missing \s, ` and '.
	(Makefile.in): Only one '-' in '-Wall'.

	configury: install correctly from './configure; make all install'.
	The latest 'm4/ax_lua.m4' sets up pkgluadir to point into Lua's
	module directory.
	* Makefile.am (install_edit, inplace_edit): Remove useless
	@pkgdatadir@ and @pkgdocdir@ substitutions.
	* src/specl.mk (specldatadir): Remove.
	(specl_install_edit, specl_inplace_edit): Use pkgluadir instead.
	(dist_specldata_DATA): Rename from this...
	(dist_pkglua_DATA): ...to this.
	* src/specl.in (package.path): Inject pkgluadir substitution.
	(PATH_DATA, PATH_DOCDIR): Remove.  Unused variables.

	configury: add rockspec machinery.
	* specl-rockspec.lua: New file. Rockspec data.
	* build-aux/mkrockspecs.lua: New file. Reuben's templating
	rockspec building script.
	* GNUmakefile (luarocks-config.lua, rockspecs): Use it to build
	rockspecs.
	* src/specl.mk (EXTRA_DIST): Add build-aux/mkrockspecs.lua.

2013-02-24  Gary V. Vaughan  <gary@gnu.org>

	specs: specl specs for specl.
	* src/specl.mk (check-local): Run specs with 'make check'.

	configury: use ./bootstrap && ./configure && make & sudo make install.
	* bootstrap: New file, from Libtool master HEAD.
	* bootstrap.conf: New file.  Configure bootstrap for Specl.
	* build-aux/gitlog-to-changelog: New file.  Required for
	'make dist'.
	* configure.ac: New file. Check Specl build prerequisites.
	* m4/ax_compare_version.m4, m4/ax_lua.m4, m4/ax_with_prog.m4:
	New files. Used by configure.ac.
	* src/version.lua.in: New file.  Configured constants.
	* specl: Moved from here...
	* specl.in: ...to here.  Rework to use src/version.lua.in.
	* Makefile.am: New file. Top-level non-recursive Makefile.
	* src/specl.mk: New file. Make fragment for specl directory.
	* .gitignore, build-aux/.gitignore, src/.gitignore: New files.

2013-02-22  Gary V. Vaughan  <gary@gnu.org>

	specl: set _G._SPEC to allow modules to expose additional APIs.
	When a non-public API is being specified, we need a way to inform
	the module to give the specification access to it.
	* specl (_G._SPEC): Set this to true.
	* src/specl.lua (M): Put _expect into the module table if it is set.
	(matchers.contain): Improve wording of error message.
	* specs/specl_spec.lua (describe contain matcher): Add spec for
	error message.
	* src/specl.lua (matchers.match): Improve wording of error message.
	* specs/specl_spec.lua (describe match matcher): Add spec for error
	message.

	maint: store the version number in the interface table.
	* src/specl.lua (M): Add _VERSION key.
	* specl (prog): Use it in the --version output.

	matchers: compare table key/value contents using contain matcher.
	* src/specl.lua: When checking expectations against a table,
	compare against each key and value in the table.
	* specs/specl_spec.lua: Remove fake specs.
	Specify behaviour of contain matcher.
	* specl: Remove obsolete TODO entries.
	* README.md: Document it.

	formatters: Be consistent when reporting met expectations.
	* src/specl.lua (report): Add "Met" prefix to output.
	(progress): Write "expectations met", not "examples worked".

	matchers: make the contain and match matchers useable.
	Fix some silly bugs preventing these matchers from working
	properly.
	* src/specl.lua (matchers.match): Use VALUE consistently for
	parameter name.
	Set the return condition properly.
	(matchers.contain): Likewise.
	string.match patterns are not anchored, so no need to bookend
	with .*.

2013-02-21  Gary V. Vaughan  <gary@gnu.org>

	docs: initial draft documentation in README.
	* README.md: Rewritten with initial draft documentation.

2013-02-20  Gary V. Vaughan  <gary@gnu.org>

	matchers: make the error matcher useable.
	* src/specl.lua (matchers.error): Take arguments in reverse, so
	that 'should_error' is called like pcall, and 'expect' is a
	substring to match against any resulting error message.
	(report.expectation): Since error messages can be very long,
	reindent multiple lines as best as possible.

	matchers: work properly with _not_ expectations.
	* src/specl.lua (q): New function to quote strings in failure
	messages nicely.
	(matchers): Always return the failure status message, even if
	the matcher succeeded, since it may be inverted later with a 'not'.

	formatters: nicer fail message for report formatter.
	* src/specl.lua (report.expectations): Reformat slightly for
	better english, and to stand out better.

	formatter: group and format expectations every example.
	Fix a bug that counts a FAILed expectation incorrectly. Restart
	the counter for every example, not just at the start of the
	entire group.
	* src/specl.lua (run_examples): Don't save up all the expectations
	from the entire group before displaying, format them after every
	example completes.

	environments: fix the environment sharing TODO.
	* src/specl.lua (run_examples): Pass the correct block environment
	into the block, so that befores share settings with examples and
	afters correctly, and then reset when they go out of scope.
	* specl: Remove TODO.

	specl: implement an alternate format, selected by -v option.
	* specl (options): Accept -v or -verbose.
	* src/specl.lua (run): Add new format parameter.  Assuming what
	is passed conforms to the API, that formatter will be called as
	the examples are executed.
	(formatter): Move from here...
	(report): ...to here.
	(progress): New formatter that just prints dots as examples pass,
	or F as they fail.
	(formatter): Default formatter is the new progress formatter.
	(M): Put the two formatters in the public interface.
	* specl: Request the old report formatter in verbose mode.

	maint: refill copyright notices.

	specl: write a command line interface.
	* src/specl.lua: Don't clobber the global namespace with anything.
	(M): Record and return APIs.
	(Fake specs): Move from here...
	* specs/specl_spec.lua: New file. ...to here.
	* specl: New file. Load the specl module, and use it to process
	each spec file passed on the command line.
	* README.md: Update.

	maint: fix mistakes in pasted copyright header.
	* src/specl.lua: Actually, not part of GNU Zile, and didn't exist
	at all for the first 4 years of the 2009-2013 copyright range.

	maint: add README.
	* README.md: New file. Barely useful at the moment...

	specl: initial import.
